### 首先看一些不常见的命令

1. **SCAN**的用法：迭代所有的key，每次返回少量数据，如果要迭代地访问所有的key就需要多次使用scan命令，直到返回的第一个数字为0。这个过程称为一次完整迭代
   1. 如果某一个元素在scan开始前在集合中，在scan结束后还在集合中，那么它一定会出现在一次完整迭代的过程中，但是它可能会出现多次。
   2. 如果一个元素在中途加入集合，那么它可能会出现也可能不会。
   3. 不保证每次返回的key的数量为某一个值



**什么是bigkey**

大key指的不是key很大，而是key对应的value很大（大于10K）或者是set zset hash list里面存了过多元素（10240个元素）。这些bigkey在被删除的时候往往会突然造成压力变大（因为redis是单线程的）

**如何减少bigkey的出现**

对于第一种情况，尝试使用hash进行分割存储

对于第二种情况，比如一个hash里存了100000个键值对，那么就换成10个hash,各存储10000个键值对。

**如果出现了bigkey，在删除时，非字符串的bigkey，不要使用del删除，使用hscan、sscan、zscan方式渐进式删除，同时要注意防止bigkey过期时间自动删除问题(例如一个200万的zset设置1小时过期，会触发del操作，造成阻塞）**

1. Hash **bigkey**删除方法：

   如果一个hash里面存储了过多的键值对，如果你要一次性把里面所有的键值对删除的话就会比较慢，而且会影响其他人的使用，那就使用hscan+hde，每次获取一批key-value，然后用hdel删除这一批key，最后删除hashkey

2. List **bigkey**删除方法：

   先计算list的长度，使用ltrim每次删除指定个数的元素，最后删除Listkey

3. Set **bigkey**的删除方法：

   sscan+srem(remove member)

   

   

